<HTML>
<head>
<meta http-equiv="content-type" content="text/html; charset=gb2312">
<link rel="stylesheet" href="temp1.css" type="text/css">
</head>
<body bgcolor=#ffffff vlink=#0000ff>
<br>
<p class="sz1">2.函数</p><hr color=#2266ee size=1>
　　Supcan Chart的函数是通过插件/加载项的 func( string funcname, string paras ) 函数间接调用的，Supcan Chart组件的可用funcname如下:<br>
<table width="94%" border="1" align="center">
<tr><th>分类</th><th>函数名</th><th>用途</th></tr>
<tr><td rowspan=17>全部函数</td><td><a href="#TagFuncTableAddSeries"><div id="func_TagFuncTableAddSeries"/>AddSeries</a></td><td>增加一个系列</td></tr>
<tr><td><a href="#TagFuncTableDeleteSeries"><div id="func_TagFuncTableDeleteSeries"/>DeleteSeries</a></td><td>删除一个系列</td></tr>
<tr><td><a href="#TagFuncTableDeleteAllSeries"><div id="func_TagFuncTableDeleteAllSeries"/>DeleteAllSeries</a></td><td>删除全部系列</td></tr>
<tr><td><a href="#TagFuncTableSetItemData"><div id="func_TagFuncTableSetItemData"/>SetItemData</a></td><td>改变某个数据项的数据</td></tr>
<tr><td><a href="#TagFuncTableGetItemData"><div id="func_TagFuncTableGetItemData"/>GetItemData</a></td><td>取得某个数据项的数据</td></tr>
<tr><td><a href="#TagFuncTableGetItemPercent"><div id="func_TagFuncTableGetItemPercent"/>GetItemPercent</a></td><td>取得某个数据项的百分比</td></tr>
<tr><td><a href="#TagFuncTableGetItemName"><div id="func_TagFuncTableGetItemName"/>GetItemName</a></td><td>取得某个数据项的ID</td></tr>
<tr><td><a href="#TagFuncTableGetItemText"><div id="func_TagFuncTableGetItemText"/>GetItemText</a></td><td>取得某个数据项的显示文字</td></tr>
<tr><td><a href="#TagFuncTableSetItemText"><div id="func_TagFuncTableSetItemText"/>SetItemText</a></td><td>设置某个数据项的显示文字</td></tr>
<tr><td><a href="#TagFuncTableSetProp"><div id="func_TagFuncTableSetProp"/>SetProp</a></td><td>更改外观属性</td></tr>
<tr><td><a href="#TagFuncTableGetProp"><div id="func_TagFuncTableGetProp"/>GetProp</a></td><td>取得属性值</td></tr>
<tr><td><a href="#TagFuncTableLoad"><div id="func_TagFuncTableLoad"/>Load</a></td><td>加载数据</td></tr>
<tr><td><a href="#TagFuncTableAddLine"><div id="func_TagFuncTableAddLine"/>AddLine</a></td><td>添加一条水平线</td></tr>
<tr><td><a href="#TagFuncTableDeleteLine"><div id="func_TagFuncTableDeleteLine"/>DeleteLine</a></td><td>删除一条水平线</td></tr>
<tr><td><a href="#TagFuncTableEnableMenu"><div id="func_TagFuncTableEnableMenu"/>EnableMenu</a></td><td>配置内置的右键菜单项，使之能显示</td></tr>
<tr><td><a href="#TagFuncTableDisableMenu"><div id="func_TagFuncTableDisableMenu"/>DisableMenu</a></td><td>配置内置的右键菜单项，使之不显示</td></tr>
<tr><td><a href="#TagFuncTableGetHandle"><div id="func_TagFuncTableGetHandle"/>GetHandle</a></td><td>取得内部非模式对话框的句柄</td></tr>
</table>


<br> 函数详解:
<div id="TagFuncTableAddSeries"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>AddSeries</td><td class="funcTD">增加一个系列</td><td align="right" style="border-left:0px;"><img src="documentg.bmp" title="请参见小型页面控件的演示页: 1.体验统计图、2.与Treelist联动">&nbsp;&nbsp;<a href="#func_TagFuncTableAddSeries"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>系列名，允许以|分隔中英文(用于中英文切换)</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>数据项的ID, 各个ID之间以Tab(即\t)分隔</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>数据项对应的数据，各个数据之间以Tab(即\t)分隔</td></tr>
  <tr><td align=right>参数4</td><td colspan=2>可选，格式为 chart=[?], 表示强制让本系列用单独的统计图类型混搭显示，chart可以为bar,line,curve,area这几种，并且只在坐标类中生效</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>备注</td><td colspan=2>如果同名系列已经存在，则替换之</td></tr>
  <tr bgColor=yellow><td align=right>示例</td><td colspan=2>AF.func("addSeries", "一月份 \r\n 销售一部\t销售二部\t销售三部 \r\n 12000\t 3000\t 10000"); <br>
AF.func("addSeries", "一月份 \r\n 销售一部\t销售二部\t销售三部 \r\n 12000\t 3000\t 10000 \r\n chart=line"); 
</td></tr>
</table>
<br>

<div id="TagFuncTableDeleteSeries"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>DeleteSeries</td><td class="funcTD">删除一个系列</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableDeleteSeries"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>系列名</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>(无)</td></tr>
</table>
<br>

<div id="TagFuncTableDeleteAllSeries"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>DeleteAllSeries</td><td class="funcTD">删除全部系列</td><td align="right" style="border-left:0px;"><img src="documentg.bmp" title="请参见小型页面控件的演示页: 2.与Treelist联动">&nbsp;&nbsp;<a href="#func_TagFuncTableDeleteAllSeries"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>(无)</td></tr>
</table>
<br>

<div id="TagFuncTableSetItemData"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>SetItemData</td><td class="funcTD">改变某个数据项的数据</td><td align="right" style="border-left:0px;"><img src="documentg.bmp" title="请参见小型页面控件的演示页: 2.与Treelist联动">&nbsp;&nbsp;<a href="#func_TagFuncTableSetItemData"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>系列名</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>数据项ID，或顺序号(从0开始)</td></tr>
  <tr><td align=right>参数3</td><td colspan=2>数据</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>(无)</td></tr>
</table>
<br>

<div id="TagFuncTableGetItemData"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>GetItemData</td><td class="funcTD">取得某个数据项的数据</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableGetItemData"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>系列名</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>数据项ID，或顺序号(从0开始)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值，空串表示该数据项不存在</td></tr>
</table>
<br>

<div id="TagFuncTableGetItemPercent"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>GetItemPercent</td><td class="funcTD">取得某个数据项的百分比</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableGetItemPercent"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>系列名</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>数据项ID，或顺序号(从0开始)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>数值，空串表示该数据项不存在</td></tr>
</table>
<br>

<div id="TagFuncTableGetItemName"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>GetItemName</td><td class="funcTD">或GetItemID,  取得某个数据项的ID</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableGetItemName"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>系列名</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>顺序号(从0开始)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串，空串表示已超出范围</td></tr>
</table>
<br>

<div id="TagFuncTableGetItemText"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>GetItemText</td><td class="funcTD">取得某个数据项的显示文字</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableGetItemText"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>数据项ID</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>串</td></tr>
</table>
<br>

<div id="TagFuncTableSetItemText"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>SetItemText</td><td class="funcTD">设置某个数据项的显示文字</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableSetItemText"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>数据项ID</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>文字串, 允许以|分隔中英文(用于中英文切换)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>(无)</td></tr>
</table>
<br>

<div id="TagFuncTableSetProp"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>SetProp</td><td class="funcTD">更改外观属性</td><td align="right" style="border-left:0px;"><img src="documentg.bmp" title="请参见小型页面控件的演示页: 1.体验统计图、2.与Treelist联动">&nbsp;&nbsp;<a href="#func_TagFuncTableSetProp"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>可以是 chart、textContent、textArrange、titlePosition、items 等创建参数, 请参见“创建实例”中的子串名(即属性名)</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>属性的值</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>(无)</td></tr>
</table>
<br>

<div id="TagFuncTableGetProp"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>GetProp</td><td class="funcTD">取得属性值</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableGetProp"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>可以是 chart、textContent、textArrange、titlePosition、items 等创建参数, 请参见“创建实例”中的子串名(即属性名)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>属性的值</td></tr>
</table>
<br>

<div id="TagFuncTableLoad"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>Load</td><td class="funcTD">加载数据</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableLoad"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>数据的URL，或直接就是XML/JSON大串，数据格式请参见本文档"3.Load的数据格式"</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选，格式为 mode = [?], 含义如下：<br>
<b>mode</b> - synch或asynch，表示同步或异步加载数据，默认是同步
</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>1/0 - 成功/失败</td></tr>
  <tr bgColor=yellow><td align=right>示例</td><td colspan=2>AF.func("load", "../chart/chartdata.aspx  \r\n mode=asynch");</td></tr>
</table>
<br>

<div id="TagFuncTableAddLine"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>AddLine</td><td class="funcTD">添加一条水平线</td><td align="right" style="border-left:0px;"><img src="documentg.bmp" title="请参见小型页面控件的演示页: 2.与Treelist联动">&nbsp;&nbsp;<a href="#func_TagFuncTableAddLine"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>类似这样的固定格式：data=[?];Text=[?];Color=[?];style=[?];ID=[?]，含义为: <br>
<b>data</b> - 可以是绝对数，或者是“ave”或"AllAve"、"AllAveNoComp" 这样的串, "ave"表示平均线, "AllAve"表示是多系列情况下的总的平均线, "AllAveNoComp"表示扣除混搭部分后的多系列总的平均线; <br>
<b>text</b> - 串，显示在坐标左侧; <br>
<b>Color</b> - 线条颜色,  默认是#C0C0C0; <br>
<b>Style</b> - 线型，可以为 Solid、Dot、DashDot，默认是Solid; <br>
<b>ID</b> - ID号，用于DeleteLine( )函数，如果不调用该函数，则不需要定义，默认是空; <br>
		</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>(无)</td></tr>
  <tr><td align=right>备注</td><td colspan=2>仅在柱状图、折线图、曲线图、区域图时显示</td></tr>
  <tr bgColor=yellow><td align=right>示例</td><td colspan=2>AF.func("AddLine", "data=ave;text=平均线;color=#ff0000");</td></tr>
</table>
<br>

<div id="TagFuncTableDeleteLine"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>DeleteLine</td><td class="funcTD">删除一条水平线</td><td align="right" style="border-left:0px;"><img src="documentg.bmp" title="请参见小型页面控件的演示页: 2.与Treelist联动">&nbsp;&nbsp;<a href="#func_TagFuncTableDeleteLine"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>ID号 (在AddLine函数中定义的)</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>(无)</td></tr>
</table>
<br>

<div id="TagFuncTableEnableMenu"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>EnableMenu</td><td class="funcTD">配置内置的右键菜单项，使之能显示</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableEnableMenu"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>固定的菜单项名称，以逗号分隔，含义为: <br>
		　sort - 排序　　　　　　　　 chart - 统计图类型　　　textcontent - 文字内容　　textarrange - 文字排列<br>
		　titleposition - 标题位置　　　saveas - 另存为　　　　animation - 动画 　　　　transparency - 透明度<br>
		以及具体的统计图类型:<br>
		　pie　　bar　　line　　curve　　area　　radar<br>
		</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选， true - 仅对参数1的菜单项生效； false - 仅显示参数1的菜单项，其余的统统不显示.<br>默认是true</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>(无)</td></tr>
</table>
<br>

<div id="TagFuncTableDisableMenu"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>DisableMenu</td><td class="funcTD">配置内置的右键菜单项，使之不显示</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableDisableMenu"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数1</td><td colspan=2>同上</td></tr>
  <tr><td align=right>参数2</td><td colspan=2>可选， true - 仅对参数1的菜单项生效； false - 仅隐藏参数1的菜单项，其余的统统显示.<br>默认是true</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>(无)</td></tr>
  <tr bgColor=yellow><td align=right>示例</td><td colspan=2>AF.func("DisableMenu", "line, curve");</td></tr>
</table>
<br>

<div id="TagFuncTableGetHandle"></div><br>
<table width=98% cols=3 border=1 align="center"><col width=120><col><col width=64 align=right>
  <tr bgcolor=#EEF5FB><td class="funcTD" align=center>GetHandle</td><td class="funcTD">取得内部非模式对话框的句柄</td><td align="right" style="border-left:0px;"><a href="#func_TagFuncTableGetHandle"><img border=0 src="arrowup.gif" title="回到目录"/> </a> </td></tr>
  <tr><td align=right>参数</td><td colspan=2>可以为串:<br>
		innerDialog - 取得内部非模式对话框的freeform的句柄;<br>
		</td></tr>
  <tr><td align=right>返回值</td><td colspan=2>句柄串</td></tr>
</table>
<br>


　　此外，Chart还拥有一组和Treelist、Freeform完全一样的全局函数，请参见<a href="globalfunction.htm" target=_blank>全局函数</a>介绍。<br>
<br>



<br><br><br>
<script type='text/javascript' src='nstd.js'></script>
</body></html>